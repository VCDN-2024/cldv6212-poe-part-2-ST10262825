@model ABC_Retailer.Models.Product

@{
    ViewData["Title"] = "Edit Product";
}

<!-- Container for the form -->
<div class="container mt-5">
    <h2 class="mb-1">Edit Product</h2>

    <!-- Form starts here -->
    <form asp-action="EditProduct" method="post" enctype="multipart/form-data">
        <!-- Product ID (readonly) -->
        <div class="form-group">
            <label for="Product_Id">Product ID</label>
            <input type="number" id="Product_Id" name="Product_Id" class="form-control" min="100" max="999" required placeholder="Enter a three-digit ID" value="@Model.Product_Id" readonly />
            <span asp-validation-for="Product_Id" class="text-danger"></span>
        </div>

        <!-- Product Name -->
        <div class="form-group">
            <label for="Product_Name">Name</label>
            <input type="text" id="Product_Name" name="Product_Name" class="form-control" required placeholder="Enter product name" value="@Model.Product_Name" />
            <span asp-validation-for="Product_Name" class="text-danger"></span>
        </div>

        <!-- Description -->
        <div class="form-group">
            <label for="Description">Description</label>
            <textarea id="Description" name="Description" class="form-control" rows="2" placeholder="Enter product description">@Model.Description</textarea>
            <span asp-validation-for="Description" class="text-danger"></span>
        </div>

        <!-- Price -->
        <div class="form-group">
            <label for="Price">Price</label>
            <input type="text" id="Price" name="Price" class="form-control" required placeholder="Enter product price" value="@Model.Price" />
            <span asp-validation-for="Price" class="text-danger"></span>
        </div>

        <!-- Image Upload -->
        <div class="form-group mt-3 mb-4">
            <label for="file">Upload New Product Image (optional)</label>
            <input type="file" id="file" name="file" class="form-control-file" />
            @if (!string.IsNullOrEmpty(Model.ImageUrl))
            {
                <div class="mt-2">
                    <label>Current Image:</label>
                    <img src="@Model.ImageUrl" alt="@Model.Product_Name" style="width:100px; height:auto; border-radius: 4px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);" />
                </div>
            }
            <span asp-validation-for="ImageUrl" class="text-danger"></span>
        </div>

        <!-- Hidden fields for PartitionKey and RowKey -->
        <input type="hidden" asp-for="PartitionKey" />
        <input type="hidden" asp-for="RowKey" />

        <!-- Submit Button -->
        <div class="form-group">
            <button type="submit" class="btn btn-primary mt-1">Update Product</button>
        </div>

        <!-- Display Validation Errors -->
        @if (!ViewData.ModelState.IsValid)
        {
            <div class="mt-3 alert alert-danger">
                @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                {
                    <p>@error.ErrorMessage</p>
                }
            </div>
        }
    </form>
</div>

<!-- Script to limit Product ID input to 3 digits -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const productIdInput = document.querySelector('input[name="Product_Id"]');
        productIdInput.addEventListener('input', (event) => {
            const value = event.target.value;
            if (value.length > 3) {
                event.target.value = value.slice(0, 3);
            }
        });
    });
</script>
